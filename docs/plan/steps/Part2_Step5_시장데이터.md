# Part 2 - Step 5: 시장 데이터 수집기 (하이브리드 업데이트)

## 상태: ✅ 완료 (하이브리드 방식 적용 예정)

## 목표
SQLite 기반 히스토리컬 데이터 캐싱 + 하이브리드 실시간 업데이트

## 핵심 기능
- [x] SQLite DB 초기화 (data/market_data.db)
- [x] 252일치 히스토리컬 데이터 저장
- [x] 증분 업데이트 (최신 데이터만 추가)
- [x] VIX 현물/선물 조회
- [x] Z-Score 계산
- [ ] **하이브리드 업데이트** (신규)

## 하이브리드 업데이트 방식

### 핵심 개념
```
일봉 통계 (126일)     +     실시간 VIX
     ↓                        ↓
평균/표준편차 (1일1회)     현재가격 (이벤트)
     ↓                        ↓
        Z-Score = (현재VIX - 평균) / 표준편차
```

### 업데이트 트리거
| 트리거 | 조건 | 주기 |
|--------|------|------|
| 정기 백업 | 기본 | 5초 |
| 가격 변동 | VIX ±0.5pt | 즉시 |
| Z-Score 임계 | \|Z\| ≥ 1.0 | 1초 |

### 캐싱 전략
- 일봉 통계(평균/표준편차): 1일 1회 갱신
- 실시간 VIX: 이벤트 기반 업데이트
- DB 연결: 멀티스레드 허용 (`check_same_thread=False`)

## 완료 조건
- [x] DB 파일 생성됨 (data/market_data.db)
- [x] VIX 데이터 조회 성공
- [x] Z-Score 계산 성공
- [ ] 하이브리드 업데이트 구현
